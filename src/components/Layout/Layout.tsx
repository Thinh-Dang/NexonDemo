import { FC } from 'react';
import style from './Layout.module.scss';

import Head from 'next/head';
import { useRouter } from 'next/router';
import { isMobile } from 'react-device-detect';
import { useAppSelector, RootState } from '@/redux';

import { Alert } from 'antd';
import { Footer, Header } from '../common';
import { ILayout } from '@/@type/components';

export const Layout: FC<ILayout> = ({
  children,
  isHeader = true,
  isFooter = true,
  isLogo = false,
  title,
}) => {
  const router = useRouter();
  const location = router.pathname;
  const isLogin = useAppSelector((state: RootState) => state.userSlice) || true;

  if (isMobile) {
    if (
      !isLogin &&
      location !== '/auth/login' &&
      location !== '/auth/register'
    ) {
      router.push('/auth/login');
      return <></>;
    } else {
      return (
        <div className={style.layout}>
          <Head>
            <title>{title}</title>
            <meta name="description" content="Generated by create next app" />
            <link rel="icon" href="/favicon.ico" />
          </Head>
          {isHeader && <Header isLogo={isLogo} />}
          <div className={style.children}>{children}</div>
          {isFooter && <Footer />}
        </div>
      );
    }
  }

  return (
    <div className={style.layout__alert}>
      <Alert
        message="CẢNH BÁO THIẾT BỊ"
        description="Website chỉ hoạt động trên thiết bị mobile. Cảm ơn !!!"
        type="error"
        showIcon
      />
    </div>
  );
};
